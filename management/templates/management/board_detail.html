{% extends 'base_manager.html' %}
{% block title %}공지사항 상세보기{% endblock %}

{% block content %}
{% load custom_filters %}
<div class="notice-detail-container">
    <p class="notice-date">{{ board.create_time|date:"Y.m.d" }}</p>
    <h2 class="notice-title">{{ board.title }}</h2>

    {% if board.file %}
        <div class="notice-image">
            <img src="{{ board.file.url }}" alt="게시된 이미지">
        </div>
    {% endif %}

    <div class="notice-body">
        {{ board.body|safe }}
    </div>

    <form method="post" action="{% url 'management:board_edit' board.id %}" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="notice-file-download">
            <input type="file" class="form-control" name="file" accept=".jpg, .jpeg, .png" {% if not is_editing %}disabled{% endif %}>
            <small class="form-text text-muted">jpg, jpeg, png 파일만 업로드 가능합니다.</small>
            {% if board.file %}
            <div>
                <strong>파일명:</strong> {{ board.file.name|basename }}
            </div>
            {% else %}
            <div>
                <strong>파일명:</strong> 파일이 첨부되어 있지 않습니다.
            </div>
            {% endif %}
            {% if error %}
            <div style="color: red;">{{ error }}</div>
            {% endif %}
        </div>
        
        <div class="notice-navigation">
            <a onclick="history.back()" class="btn btn-primary">뒤로가기</a>
            {% if board.file %}
            <a href="{{ board.file.url }}" class="btn btn-primary" download>파일 다운로드</a>
            {% endif %}
            <input type="button" class="btn btn-primary" id="edit-button" value="수정">
            <input type="submit" class="btn btn-primary" id="save-button" style="display: none;" value="저장">
            <a href="{% url 'management:board_delete' board.id %}" class="btn btn-danger" onclick="return confirm('정말로 삭제하시겠습니까?')">삭제</a>
        </div>
    </form>
</div>

<style>
    @font-face {
        font-family: 'GmarketSansMedium';
        src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff') format('woff');
        font-weight: normal;
        font-style: normal;
    }

    body {
        font-family: 'GmarketSansMedium', sans-serif;
    }

    .notice-title {
        font-size: 2rem;
    }

    .notice-date {
        color: #666;
        margin-bottom: 1.2rem;
        font-size: 1.1rem;
    }

    .notice-body {
        font-size: 1.4rem;
        line-height: 1.25;
        color: #666;
    }

    .notice-image {
        text-align: center;
        margin: 20px 0;
    }

    .notice-image img {
        max-width: 100%;
        height: auto;
        border-radius: 4px;
    }

    .notice-file-download {
        margin: 20px 0;
    }

    .notice-file-download a {
        color: #007bff;
        text-decoration: none;
        font-size: 16px;
    }

    .notice-file-download a:hover {
        text-decoration: underline;
    }

    .notice-navigation {
        margin-top: 4rem;
        padding-top: 4rem;
        padding-bottom: 4rem;
        border-top: 1px solid #E9EBF2;
        text-align: center;
        background-color: #fff;
    }

    .btn-primary {
        background-color: #007bff;
        color: #fff;
        border: none;
        padding: 10px 20px;
        font-size: 1.6rem;
        font-weight: 500;
        border-radius: 0.8rem;
        width: 20rem;
        max-width: none;
        text-decoration: none;
        display: inline-block;
        text-align: center;
    }

    .btn-primary:hover {
        background-color: #0056b3;
        text-decoration: none;
    }

    .btn-danger {
        background-color: #dc3545;
        color: #fff;
        border: none;
        padding: 10px 20px;
        font-size: 1.6rem;
        font-weight: 500;
        border-radius: 0.8rem;
        width: 20rem;
        max-width: none;
        text-decoration: none;
        display: inline-block;
        text-align: center;
    }

    .btn-danger:hover {
        background-color: #c82333;
        text-decoration: none;
    }
</style>

<script>
    document.getElementById('edit-button').onclick = function() {
        var inputs = document.querySelectorAll('.form-control');
        inputs.forEach(function(input) {
            input.disabled = false;
        });
        document.getElementById('save-button').style.display = 'inline-block';
        document.getElementById('edit-button').style.display = 'none';
    }
</script>
{% endblock %}
